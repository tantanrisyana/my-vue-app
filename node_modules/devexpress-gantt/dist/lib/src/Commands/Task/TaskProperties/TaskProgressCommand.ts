import { TaskProgressHistoryItem } from "../../../Model/History/HistoryItems/Task/Properties/TaskProgressHistoryItem";
import { TaskPropertyCommandBase } from "./TaskPropertyCommandBase";

export class TaskProgressCommand extends TaskPropertyCommandBase {
    public execute(id: string, value: number): boolean {
        return super.execute(id, value);
    }
    protected executeInternal(id: string, value: number): boolean {
        return this.modelManipulator.dispatcher.raiseTaskProgressUpdating(
            this.getTask(id),
            value,
            (newValue) => {
                this.control.history.beginTransaction();
                this.history.addAndRedo(new TaskProgressHistoryItem(this.modelManipulator, id, newValue));
                this.validationController.updateParentsIfRequired(id);
                this.control.history.endTransaction();
            }
        );
    }
}
